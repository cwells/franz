#
# test yield
#

print("Testing yield...")
errors = 0

loop = fn (n: int)
    for i in 1 to n
        yield i

pairs = fn (n: int)
    for i in 1 to n
        yield (yield i) ^ 2

squares = fn (n: int)
    for i in 1 to n
        yield [ i, i ^ 2 ]

try assert loop(5) == [ 1, 2, 3, 4, 5 ] rescue errors++
try assert pairs(4) == [ 1, 1, 2, 4, 3, 9, 4, 16 ] rescue errors++
try assert squares(4) == [ [1, 1], [2, 4], [3, 9], [4, 16] ] rescue errors++

print(if errors "Some tests failed ({errors}) errors\n" else "passed!\n")
