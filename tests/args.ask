#
# test argument passing
#
errors = 0
print("Testing function arguments...")

test = fn (a: int, b: int, c: int, d: int)
    v = a + b + c + d

a = 1
b = 2

try assert test(a: 1, b: 2, c: 3, d: 4) == 10   # named args
rescue errors++

try assert test(1, 2, 3, 4) == 10               # positional args
rescue errors++

try assert test(1, 2, c: 3, d: 4) == 10         # mixture
rescue errors++

try assert test(a, b, b + 1, d: b * 2) == 10    # simple expressions
rescue errors++

try assert test( # complex expression
    a: 1,
    b: 2,
    c: 3,
    d: for i in 1 to 4 i
) == 10
rescue errors++

try assert test( # complex expression
    a: 1,
    b: 2,
    c: 3,
    d: if a == 1 for i in 1 to 4 i
) == 10
rescue errors++


test = fn () { # empty argument list
    return # BUG! must have braces with 'return' - probably due to stack unwinding from exception
}

try assert test() == nil
rescue errors++

print(if errors "Some tests failed ({errors}) errors\n" else "passed!\n")

